# 知识点梳理

* 浏览器加载到渲染的过程
* 性能优化
* Web安全

## 加载页面和渲染过程

tips 加载过程和渲染过程分开说。简明扼要、抓住要点，不拖沓

> 浏览器从加载到渲染页面的过程

加载过程： 要点

1. 浏览器根据DNS服务器得到域名的IP地址
2. 向这个IP的机器发送HTTP请求
3. 服务器收到、处理并返回HTTP请求
4. 浏览器得到返回结果(html)

渲染过程

1. 根据HTML结构生成DOM树
2. 根据CSS生成CSSOM树
3. 将DOM和CSSOM整合形成RenderTree
4. 根据RenderTree开始渲染和展示
5. 遇到`script`时会执行并阻塞渲染

> link、img、script的下载是异步的，而执行是阻塞的。

为何要将CSS放在HTML头部？

这样会让浏览器尽早拿到CSS尽早生成CSSOM，然后在解析HTML后之后一次性生成最终的RenderTree，渲染一次即可。如果CSS放在HTML底部，会出现渲染卡顿的情况，影响性能和体验。

为何要将JS放在HTML底部？

JS放在底部可以保证让浏览器优先渲染完现有的HTML内容，让用户先看到内容，体验好。另外，JS执行如果涉及DOM操作，得等待DOM解析完成之后

参考推荐 [《从输入 URL 到页面加载完成的过程中都发生了什么事情》](https://link.juejin.im/?target=http%3A%2F%2Ffex.baidu.com%2Fblog%2F2014%2F05%2Fwhat-happen%2F)


## 性能优化

> 总结前端性能优化的解决方案

**优化原则：**以更好的用户体验为标准

1. 多使用内存、缓存或者其他方法
2. 减少CPU和GPU计算，更快展现

**优化方向：**

1. 减少页面体积，提升网络加载
2. 优化页面渲染

### 减少页面体积，提升网络加载

* 静态资源的合并与压缩（JS代码合并压缩、CSS代码合并压缩、雪碧图等）
* 静态资源缓存（资源名加MD5戳）
* 使用CDN让资源加载更快

### 优化页面渲染

* CSS放前，JS放后
* 懒加载（图片懒加载、下拉加载更多）
* 减少DOM查询，对DOM查询做缓存
* 减少DOM操作，多个操作尽量合并在一起执行
* 事件节流
* 尽早执行操作（DOMContentLoaded）
* 使用SSR服务端渲染，数据直接输出到HTML，即使浏览器使用JS模版渲染页面的时间

### 性能优化如何做

1. 建立性能数据收集平台，摸底当前性能数据，通过性能打点，将上述整个页面打开过程消耗时间记录下来
2. 分析耗时较长时间段原因，寻找优化点，确定优化目标
3. 开始优化
4. 通过数据收集平台记录优化结果
5. 不断调整优化点和预期目标，循环2~4步骤

## web安全

> 前端常见的安全问题有哪些

### XSS Cross Site Scripting 跨站脚本攻击

原理：通过某种方式（输入框发布文章评论等）将一段特定的JS代码隐蔽地输入进去，当别人再看或者评论时，之前注入的JS开始执行，因为它跟原网页JS有同样权限，获取server端数据、cookie等。

**预防**

输入内容进行验证和替换，需要转义的字符：

* `&` -> `&amp;`
* `<` -> `&lt;`
* `>` -> `&gt;`
* `"` -> `&quot;`
* `'` -> `&#x27;`
* `/` -> `&#x2f`;

还可通过对cookie进行控制，增加`http-only`限制，让JS获取不到cookie内容

### CSRF Cross Site Request Forgery 跨站请求伪造

CSRF 是借用了当前操作者的权限来偷偷地完成某个操作，而不是拿到用户的信息。

预防CSRF就是加入各个层级的权限验证。接口使用POST
