## loaderåŒ¹é…è§„åˆ™

```js
module.exports = {
  // ...
  module: {
    rules: [
      {
        test: /\.jsx?/, // æ¡ä»¶
        include: [
          path.resolve(__dirname, 'src'),
        ], // æ¡ä»¶
        use: 'babel-loader', // è§„åˆ™åº”ç”¨ç»“æœ
      }, // ä¸€ä¸ª object å³ä¸€æ¡è§„åˆ™
      // ...
    ],
  },
}
```

loaderçš„åŒ¹é…è§„åˆ™ä¸­æœ‰ä¸¤ä¸ªå…³é”®å› ç´ ï¼Œä¸€ä¸ªæ˜¯åŒ¹é…æ¡ä»¶ï¼Œä¸€ä¸ªæ˜¯åŒ¹é…è§„åˆ™åçš„åº”ç”¨ã€‚

åŒ¹é…æ¡ä»¶é€šå¸¸ä½¿ç”¨è¯·ä½ æ»šçƒèµ„æºçš„ç»å¯¹è·¯å¾„æ¥åŒ¹é…`resource`ï¼Œé™¤æ­¤è¿˜æœ‰è¾ƒå°‘ç”¨åˆ°çš„`issuer`(å£°æ˜ä¾èµ–è¯·æ±‚çš„æºæ–‡ä»¶çš„ç»å¯¹è·¯å¾„)

### è§„åˆ™æ¡ä»¶é…ç½®

é…ç½®loaderåŒ¹é…æ¡ä»¶ï¼Œä¸€èˆ¬ä½¿ç”¨`test`å°±å¥½ã€‚è‹¥éœ€é…ç½®è¾ƒå¤æ‚çš„åŒ¹é…æ¡ä»¶ï¼Œwebpackçš„è§„åˆ™æä¾›äº†å¤šç§é…ç½®å½¢å¼ï¼š

* test åŒ¹é…ç‰¹å®šæ¡ä»¶
* include åŒ¹é…ç‰¹å®šè·¯å¾„
* exclude æ’é™¤ç‰¹å®šè·¯å¾„
* and å¿…é¡»åŒ¹é…æ•°ç»„ä¸­çš„æ‰€æœ‰æ¡ä»¶
* or åŒ¹é…æ•°ç»„ä¸­çš„ä»»ä¸€æ¡ä»¶
* not æ’é™¤åŒ¹é…æ•°ç»„ä¸­çš„æ¡ä»¶

ä¸Šè¿°çš„æ‰€è°“æ¡ä»¶çš„å€¼å¯ä»¥æ˜¯ï¼š

* å­—ç¬¦ä¸²ï¼šå¿…é¡»ä»¥æä¾›çš„å­—ç¬¦ä¸²å¼€å§‹ï¼Œæ‰€ä»¥æ˜¯å­—ç¬¦ä¸²çš„è¯ï¼Œè¿™é‡Œæˆ‘ä»¬éœ€è¦æä¾›ç»å¯¹è·¯å¾„
* æ­£åˆ™è¡¨è¾¾å¼ï¼šè°ƒç”¨æ­£åˆ™çš„ test æ–¹æ³•æ¥åˆ¤æ–­åŒ¹é…
* å‡½æ•°ï¼š(path) => booleanï¼Œè¿”å› true è¡¨ç¤ºåŒ¹é…
* æ•°ç»„ï¼šè‡³å°‘åŒ…å«ä¸€ä¸ªæ¡ä»¶çš„æ•°ç»„
* å¯¹è±¡ï¼šåŒ¹é…æ‰€æœ‰å±æ€§å€¼çš„æ¡ä»¶

### module type

webpack 4.xç‰ˆæœ¬åï¼Œæ¨¡å—ç±»å‹æ¦‚å¿µã€‚ä¸åŒæ¨¡å—ç±»å‹ç±»ä¼¼äºé…ç½®äº†ä¸åŒçš„loader

* javascript/autoï¼šå³ webpack 3 é»˜è®¤çš„ç±»å‹ï¼Œæ”¯æŒç°æœ‰çš„å„ç§ JS ä»£ç æ¨¡å—ç±»å‹ â€”â€” CommonJSã€AMDã€ESM
* javascript/esmï¼šECMAScript modulesï¼Œå…¶ä»–æ¨¡å—ç³»ç»Ÿï¼Œä¾‹å¦‚ CommonJS æˆ–è€… AMD ç­‰ä¸æ”¯æŒï¼Œæ˜¯ .mjs æ–‡ä»¶çš„é»˜è®¤ç±»å‹
* javascript/dynamicï¼šCommonJS å’Œ AMDï¼Œæ’é™¤ ESM
* javascript/jsonï¼šJSON æ ¼å¼æ•°æ®ï¼Œrequire æˆ–è€… import éƒ½å¯ä»¥å¼•å…¥ï¼Œæ˜¯ .json æ–‡ä»¶çš„é»˜è®¤ç±»å‹
* webassembly/experimentalï¼šWebAssembly modulesï¼Œå½“å‰è¿˜å¤„äºè¯•éªŒé˜¶æ®µï¼Œæ˜¯ .wasm æ–‡ä»¶çš„é»˜è®¤ç±»å‹

### ä½¿ç”¨loaderé…ç½®

`module.rules`åŒ¹é…è§„åˆ™æœ€é‡è¦çš„è¿˜æ˜¯ç”¨äºé…ç½®loaderï¼Œæˆ‘ä»¬å¯ä»¥ç”¨useå­—æ®µï¼š

```js
rules: [
  {
    test: /\.less/,
    use: [
      'style-loader',
      {
        loader: 'css-loader,
        options: {
          importLoaders: 1
        }
      }, // ç”¨å¯¹è±¡è¡¨ç¤ºloaderï¼Œå¯ä»¥ä¼ é€’loaderé…ç½®ç­‰
      {
        loader: 'less-loader',
        options: {
          noIeCompat: true
        } // ä¼ é€’loaderé…ç½®
      }
    ]
  }
]
```

### loaderåº”ç”¨é¡ºåº

é¡¾åæ€ä¹‰ï¼Œæ‰€æœ‰çš„loaderæŒ‰ç…§`å‰ç½® -> è¡Œå†… -> æ™®é€š -> åç½®`çš„é¡ºåºæ‰§è¡Œã€‚æ‰€ä»¥å½“è¦ç¡®ä¿eslint-loaderåœ¨babel-loaderä¹‹å‰æ‰§è¡Œæ—¶ï¼Œå¯ä»¥æ·»åŠ enforceï¼Œå¦‚ä¸‹ï¼š

```js
rules: [
  {
    enforce: 'pre', // æŒ‡å®šä¸ºå‰ç½®ç±»å‹
    test: /\.js$/,
    exclude: /node_modules/,
    loader: 'eslint-loader'
  }
]
```

* ä½¿ç”¨ `noParse`

æˆ‘ä»¬ä½¿ç”¨loaderåœ¨module.rulesä¸‹é…ç½®ï¼Œè€Œwebpacké…ç½®ä¸‹çš„moduleç”¨äºæ§åˆ¶å¦‚ä½•å¤„ç†é¡¹ç›®ä¸­ä¸åŒç±»å‹çš„æ¨¡å—ã€‚

é™¤äº†module.ruleså­—æ®µç”¨äºé…ç½®loaderå¤–ï¼Œè¿˜å¯ç”¨`module.noParse`ï¼Œå¯é…ç½®å“ªäº›æ¨¡å—æ–‡ä»¶çš„å†…å®¹ä¸éœ€è¦è¿›è¡Œè§£æã€‚å¯¹äºä¸€äº›ä¸éœ€è¦`è§£æä¾èµ–`çš„ç¬¬ä¸‰æ–¹å¤§å‹ç±»åº“ç­‰ï¼Œå¯ä»¥é€šè¿‡è¯¥å­—æ®µé…ç½®ï¼Œä»¥æé«˜æ•´ä½“çš„æ„å»ºé€Ÿåº¦

> ä½¿ç”¨`noParse`è¿›è¡Œå¿½ç•¥çš„æ¨¡å—æ–‡ä»¶ä¸­ä¸èƒ½ä½¿ç”¨import require defineç­‰å¯¼å…¥æœºåˆ¶

```js
module.exports = {
  module: {
    noParse: /jQuery|lodash/,
    // æˆ–ä½¿ç”¨function
    // noParse(content) {
    //   return /jQuery|lodash/.test(content)
    // }
  }
}
```

noParse ä»æŸç§ç¨‹åº¦ä¸Šè¯´æ˜¯ä¸ªä¼˜åŒ–é…ç½®é¡¹ï¼Œæ—¥å¸¸ä¹Ÿå¯ä»¥ä¸å»ä½¿ç”¨ã€‚
